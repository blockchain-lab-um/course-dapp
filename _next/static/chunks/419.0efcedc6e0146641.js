(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[419],{8991:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(7294),s=n(29),a=n(7794),o=n.n(a),i=n(7191),c=n(5893),l=function(e){return(0,i.Z)(e),(0,c.jsxs)("div",{className:"grid justify-items-center text-white bg-blue p-10 text-3xl font-semibold",children:[(0,c.jsx)("h1",{children:"You have successfuly completed the course! "}),(0,c.jsx)("h2",{children:"VC should appear in your wallet shortly!"})]})},u=n(1144),d=n.n(u),x=function(e){var t=e.loading,n=e.msg,s=(0,r.useState)("#05386b"),a=s[0];s[1];return(0,c.jsxs)("div",{className:"sweet-loading pt-5",children:[t&&(0,c.jsx)("div",{className:"text-blue p-3 text-2xl pb-6",children:n}),(0,c.jsx)(d(),{color:a,loading:t,css:"\n  display: block;\n  margin: 0 auto;\n  border-color: #05386b;\n",size:100})]})},h=function(e){var t=e.connMetaMask;return(0,c.jsx)("div",{children:(0,c.jsx)("button",{className:"py-3 px-3 m-4 text-white text-3xl bg-blue hover:outline-blue hover:text-blue hover:bg-white outline outline-blue outline-8",onClick:t,children:"connect MetaMask"})})},p=function(e){var t=e.connected,n=e.address,r=e.connMetaMask;return(0,c.jsxs)("div",{className:"flex justify-between p-3",children:[(0,c.jsx)("div",{className:"text-blue text-6xl font-bold m-2",children:"Solidity Course"}),!t&&(0,c.jsx)(h,{connMetaMask:r}),t&&(0,c.jsx)("div",{className:"text-brown text-2xl font-bold m-2 p-5 bg-blue",children:(null===n||void 0===n?void 0:n.substring(0,10))+"..."})]})},f=function(e){var t=e.msg;return(0,c.jsx)("div",{className:"grid justify-items-center text-white bg-blue p-10 text-3xl font-semibold",children:(0,c.jsx)("h1",{children:t})})},m=function(e){var t=e.completeCourse,n=(0,r.useState)(""),s=n[0],a=n[1],o=(0,r.useState)(!1),i=o[0],l=o[1],u=function(e){l("true"===e.currentTarget.value)};return(0,c.jsx)("div",{className:"flex justify-center w-2/5 bg-blue text-white p-5 pt-10",children:(0,c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""==s||!1===i?console.log("Fill form first"):t(s),console.log("Name",s,i)},children:[(0,c.jsx)("div",{className:"text-4xl font-semibold",children:(0,c.jsxs)("label",{children:["NAME",(0,c.jsx)("input",{type:"text",name:"name",onChange:function(e){a(e.currentTarget.value)},className:"ml-2 pl-2 text-blue outline-none bg-white w-2/3"})]})}),(0,c.jsx)("br",{}),(0,c.jsx)("div",{className:"p-2 text-2xl",children:(0,c.jsxs)("label",{children:["Are you familiar with Solidity?",(0,c.jsxs)("div",{className:"pt-1",children:[(0,c.jsx)("input",{type:"radio",value:"true",name:"canProgram",onChange:u,className:"form-radio mr-2 text-green bg-white"})," ","Yes",(0,c.jsx)("input",{type:"radio",value:"false",name:"canProgram",onChange:u,className:"form-radio ml-4 text-green bg-white",defaultChecked:!0})," ","No"]})]})}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)("div",{className:"w-full flex justify-center",children:(0,c.jsx)("input",{className:"absolute mt-[-20px] py-2 px-5 m-2 text-blue text-3xl bg-white hover:outline-green hover:bg-blue hover:text-white outline outline-blue outline-8",type:"submit",value:"submit"})})]})})},b=n(6486),v=function(e){var t=e.switchView,n=e.hasVC,r=e.openSecretRoom,s=function(e){e.preventDefault();var n=e.target.name;t((0,b.toNumber)(n))};return(0,c.jsxs)("div",{className:"w-full flex justify-start text-3xl pl-3 text-bold text-blue",children:[(0,c.jsx)("button",{className:"p-3 font-bold hover:text-white hover:bg-blue",onClick:s,name:"0",children:"Course"}),(0,c.jsx)("button",{className:"p-3 font-bold hover:text-white hover:bg-blue",onClick:s,name:"1",children:"Profile"}),n&&(0,c.jsx)("button",{className:"p-3 font-bold hover:text-white hover:bg-blue",onClick:r,children:"Secret Room"})]})},g=function(e){var t=e.startCourse;return(0,c.jsxs)("div",{className:"w-3/5",children:[(0,c.jsx)("div",{className:"grid justify-items-center bg-blue p-8",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-3xl text-center text-white mb-10",children:"Start the course to recieve your VC!"}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{})]})}),(0,c.jsx)("div",{className:"flex justify-center m-[-65px]",children:(0,c.jsx)("button",{className:"py-5 px-5 m-2 text-blue text-3xl bg-white hover:outline-green hover:bg-blue hover:text-white outline outline-blue outline-8",onClick:t,children:"start"})})]})},j=function(e){var t=e.VC,n=(0,r.useState)([]),s=n[0],a=n[1],o=(0,r.useState)(!1),i=o[0],l=o[1];(0,r.useEffect)((function(){var e=JSON.stringify(t.credentialSubject).substring(1,JSON.stringify(t.credentialSubject).length-1);a(e.split(",")),console.log(e)}),[]);var u=function(){l(!i)};return(0,c.jsxs)("div",{className:"grid bg-white p-3 max-w-xl break-all m-3",children:[(0,c.jsx)("b",{children:"Issuer:"})," ",(0,c.jsx)("p",{children:t.issuer.id}),(0,c.jsx)("b",{children:"Subject:"}),(0,c.jsx)("div",{className:"p-2",children:s.map((function(e,t){return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)("a",{children:e.toString()}),(0,c.jsx)("br",{})]},t)}))}),(0,c.jsx)("b",{children:"Issuance Date:"})," ",t.issuanceDate,(0,c.jsx)("br",{}),!i&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("b",{children:"Proof:"})," ",t.proof.jwt.substring(0,50),"..."]}),i&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("b",{children:"Proof:"})," ",t.proof.jwt]}),(0,c.jsx)("br",{}),!i&&(0,c.jsx)("button",{className:"text-xl text-blue",onClick:u,children:"More..."}),i&&(0,c.jsx)("button",{className:"text-xl text-blue",onClick:u,children:"Less..."})]})},w=function(e){var t=e.VCs;return(0,c.jsx)("div",{className:"w-full p-3 flex justify-center",children:t.length>0&&t.map((function(e,t){return(0,c.jsx)(j,{VC:e.data},t)}))})},C=n(318),y=function(e){e.mmAddress;var t=e.api,n=(0,r.useState)([]),a=n[0],i=n[1];(0,r.useEffect)((function(){console.log("Getting VCs..."),t&&l()}),[]);var l=function(){var e=(0,s.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.queryVCs();case 3:if(n=e.sent,!(0,C.VZ)(n)){e.next=7;break}return console.log(n),e.abrupt("return");case 7:i(n.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{className:"w-full",children:[(0,c.jsx)("div",{className:"flex justify-center text-2xl font-bold",children:(0,c.jsx)("h1",{children:"My VCs"})}),(0,c.jsx)(w,{VCs:a})]})},k=function(e){return(0,i.Z)(e),(0,c.jsx)("footer",{className:"p-3 bg-blue text-white",children:(0,c.jsx)("div",{className:"w-full mx-auto",children:(0,c.jsx)("div",{className:"",children:(0,c.jsxs)("div",{className:" flex justify-center text-center text-sm text-white",children:[(0,c.jsx)("a",{href:"https://blockchain-lab.um.si/",className:"mx-6 hover:text-green",children:"Blockchain Lab:UM"}),(0,c.jsx)("a",{href:"https://github.com/blockchain-lab-um",className:"mx-6 hover:text-green",children:"Github"}),(0,c.jsxs)("span",{className:"mx-5",children:["Mail:",(0,c.jsx)("a",{href:"mailto:blockchain-lab@um.si",className:"mx-1 hover:text-green",children:"blockchain-lab@um.si"})]})]})})})})},N=function(e){return(0,i.Z)(e),(0,c.jsx)("div",{className:"w-full",children:(0,c.jsx)("div",{className:"flex justify-center text-2xl font-bold mt-10",children:(0,c.jsx)("div",{className:"w-3/5",children:(0,c.jsx)("div",{className:"grid justify-items-center bg-blue p-8",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-3xl text-center text-white mb-10",children:"Congratulations! You've discovered a secret room only accessible with a valid VC!"}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{})]})})})})})},S=function(e){var t=e.mmAddress,n=e.connectMetamask,r=e.spinner,s=e.courseCompleted,a=e.snapInitialized,o=e.hasVC,i=e.completeCourse,u=e.spinnerMsg,d=e.switchView,h=e.view,b=e.startCourse,j=e.courseStarted,w=e.openSecretRoom,C=e.api;return window.ethereum?(0,c.jsxs)("div",{className:"flex flex-col justify-between h-screen",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(p,{address:t,connected:null!=t,connMetaMask:n}),(0,c.jsx)(v,{switchView:d,hasVC:o,openSecretRoom:w}),(0,c.jsxs)("div",{children:[0==h&&(0,c.jsxs)("div",{className:"flex justify-center pt-5",children:[null==t&&!r&&(0,c.jsx)("div",{className:"pt-32 text-2xl",children:"Connect to the MetaMask to start the Course!"}),null!=t&&!r&&0==j&&(0,c.jsx)(g,{startCourse:b}),s&&j&&(0,c.jsx)(l,{}),null!=t&&!s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(x,{loading:r,msg:u}),a&&a&&!o&&!r&&j&&(0,c.jsx)(m,{completeCourse:i}),a&&o&&!r&&(0,c.jsx)(f,{msg:"You already have a valid VC!"})]})]}),1==h&&(0,c.jsxs)("div",{className:"flex justify-center pt-5",children:[null==t&&(0,c.jsx)("div",{className:"pt-32 text-2xl",children:"Connect to the MetaMask to view Profile!"}),null!=t&&(0,c.jsx)(y,{mmAddress:t,api:C})]}),2==h&&(0,c.jsx)(N,{})]})]}),(0,c.jsx)(k,{})]}):(0,c.jsx)(f,{msg:"MetaMask Flask not installed!"})},V=n(1605);function A(e,t){return M.apply(this,arguments)}function M(){return M=(0,s.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Attempting to connect to snap..."),console.log("Snap ID: ",n),console.log("Address: ",t),e.next=6,(0,V.m)(t,{snapId:n});case 6:if(r=e.sent,!(0,C.VZ)(r)){e.next=11;break}return console.log("Error"),console.error(r.error),e.abrupt("return",{isSnapInstalled:!1});case 11:return!0,console.log("Snap installed!"),e.abrupt("return",{isSnapInstalled:!0,snap:r.data});case 16:return e.prev=16,e.t0=e.catch(0),console.error(e.t0),!1,e.abrupt("return",{isSnapInstalled:!1});case 21:case"end":return e.stop()}}),e,null,[[0,16]])}))),M.apply(this,arguments)}function Z(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=n(9669),P="npm:@blockchain-lab-um/masca",F="https://bclabum.informatika.uni-mb.si/ssi-demo-backend",U="did:ethr:0x5:0x5Fd68bcc0Cf3844B4Ada2378b23A0bD46625CC6E";console.log("BACKEND",F,P,U);var D=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],a=(0,r.useState)(!1),i=a[0],l=a[1],u=(0,r.useState)(!1),d=u[0],x=u[1],h=(0,r.useState)(!1),p=h[0],f=h[1],m=(0,r.useState)(null),b=m[0],v=m[1],g=(0,r.useState)("loading..."),j=g[0],w=g[1],y=(0,r.useState)(0),k=y[0],N=y[1],V=(0,r.useState)(!1),M=V[0],E=V[1],D=(0,r.useState)(void 0),O=D[0],R=D[1],T=function(){var e=(0,s.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,window.ethereum&&(x(!0),w("Connecting to Snap..."),window.ethereum.request({method:"eth_requestAccounts"}).then(function(){var e=(0,s.Z)(o().mark((function e(r){var s,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Setting MM address!"),t=r[0],n(t),e.next=5,A(t,P);case 5:if(!(s=e.sent).isSnapInstalled){e.next=12;break}return e.next=9,null===(a=s.snap)||void 0===a?void 0:a.getMascaApi();case 9:i=e.sent,R(i),x(!1);case 12:x(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t||0!=M){e.next=5;break}return console.log("Starting course..."),E(!0),e.next=5,_(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var _=function(){var e=(0,s.Z)(o().mark((function e(t){var n,r,s,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!0),w("checking for existing vc..."),console.log("Checking if user already has a valid VC.."),e.prev=3,!O){e.next=45;break}return console.log("API",O),console.log("Getting VCs..."),e.next=9,O.queryVCs();case 9:if(n=e.sent,!(0,C.VZ)(n)){e.next=13;break}return console.log("Error getting VCs",n.error),e.abrupt("return");case 13:if(console.log(n),e.prev=14,!(n.data.length>0)){e.next=38;break}r=Z(n.data),e.prev=17,r.s();case 19:if((s=r.n()).done){e.next=30;break}if(a=(a=s.value).data,console.log(a.credentialSubject.id.split(":")[3].toString().toUpperCase(),t,U.toUpperCase(),a.issuer.id.toString().toUpperCase()),a.credentialSubject.id.split(":")[3].toString().toUpperCase()!==t.toUpperCase()||a.issuer.id.toString().toUpperCase()!==U.toUpperCase()){e.next=28;break}return console.log("Valid VC found!"),f(!0),v(a),e.abrupt("break",30);case 28:e.next=19;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(17),r.e(e.t0);case 35:return e.prev=35,r.f(),e.finish(35);case 38:e.next=45;break;case 40:e.prev=40,e.t1=e.catch(14),console.log("No valid VCs found!",e.t1),x(!1),w("loading...");case 45:e.next=53;break;case 47:e.prev=47,e.t2=e.catch(3),console.error(e.t2),alert("Problem happened: "+e.t2.message||0),x(!1),w("loading...");case 53:x(!1),w("loading...");case 55:case"end":return e.stop()}}),e,null,[[3,47],[14,40],[17,32,35,38]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,s.Z)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}},e.next=3,I.post(F+"/api/vc/generate-challenge",t).then((function(e){return e.data})).catch((function(e){console.log(e)}));case 3:return n=e.sent,console.log("Challenge",n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=(0,s.Z)(o().mark((function e(n,r,s){var a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),w("Verifying validity of VP"),a={headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}},i={vp:n,challenge:s,domain:r,subjectAddress:t},e.next=6,I.post(F+"/api/vc/verify-vp",i,a).then((function(e){return e.data})).catch((function(e){console.log(e)}));case 6:return c=e.sent,console.log(c),x(!1),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),z=function(){var e=(0,s.Z)(o().mark((function e(n){var r,s,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n,"Completed the course!",t),r={headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}},s={name:n,id:"did:ethr:0x5:"+t},e.next=5,I.post(F+"/api/vc/issue-vc",s,r).then((function(e){return e.data})).catch((function(e){console.log(e)}));case 5:if(a=e.sent,console.log(a),e.prev=7,!O){e.next=15;break}return e.next=11,O.saveVC(a,{store:["snap"]});case 11:i=e.sent,f(!0),v(a),console.log(i);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(7),console.error(e.t0),alert("Problem happened: "+e.t0.message||0);case 21:l(!0);case 22:case"end":return e.stop()}}),e,null,[[7,17]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,s.Z)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),w("Requesting VP"),e.next=4,B();case 4:if(t=e.sent,!O){e.next=31;break}if(b){e.next=8;break}return e.abrupt("return",!1);case 8:if(!(t&&t.domain&&t.challenge)){e.next=31;break}return e.prev=9,e.next=12,O.createVP({vcs:[b],proofFormat:"EthereumEip712Signature2021",proofOptions:{type:"",domain:t.domain,challenge:t.challenge}});case 12:if(n=e.sent,!(0,C.VZ)(n)){e.next=17;break}return console.log("Error creating VP",n.error),x(!1),e.abrupt("return",!1);case 17:return e.next=19,Y(n.data,"did:ethr:0x5:0x5Fd68bcc0Cf3844B4Ada2378b23A0bD46625CC6E",t.challenge);case 19:if(e.t0=e.sent,0==e.t0){e.next=23;break}return N(2),e.abrupt("return",!0);case 23:e.next=29;break;case 25:e.prev=25,e.t1=e.catch(9),console.error(e.t1),x(!1);case 29:return x(!1),e.abrupt("return",!1);case 31:return x(!1),w("loading..."),e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,null,[[9,25]])})));return function(){return e.apply(this,arguments)}}();return(0,c.jsx)(S,{mmAddress:t,connectMetamask:T,spinner:d,courseCompleted:i,snapInitialized:!0,hasVC:p,completeCourse:z,spinnerMsg:j,switchView:function(e){k!=e&&N(e)},view:k,startCourse:q,courseStarted:M,openSecretRoom:G,api:O})};function O(){return(0,c.jsx)("div",{className:"bg-green min-h-screen font-mono",children:(0,c.jsx)(D,{})})}},5883:function(){},6601:function(){},9214:function(){},5568:function(){}}]);